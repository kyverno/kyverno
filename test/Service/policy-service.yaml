apiVersion : kyverno.io/v1alpha1
kind : Policy
metadata :
  name : policy-service
spec :
  rules:
    - name: ps1
      resource:
        kinds: 
        - Service
        name: "game-service*"
      mutate:
        patches:
        - path: "/metadata/labels/isMutated"
          op: add
          value: "true"
        - path : "/metadata/labels/secretLabel"
          op : replace
          value : "weKnow"
        - path : "/metadata/labels/originalLabel"
          op : remove
        - path: "/spec/selector/app"
          op: replace
          value: "mutedApp"
      validate:
        message: "This service has wrong port"
        pattern:
          spec:
            ports:
            - name: "http"
              protocol: TCP
              port: 80|8080
