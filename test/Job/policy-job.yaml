apiVersion: kubepolicy.nirmata.io/v1alpha1
kind: Policy
metadata:
  name: policy-job-perl-bigint
spec :
  rules:
    - name: job1
      resource:
        kind: Job
        name: pi
      mutate:
        patches:
        - path : "/spec/template/spec/containers/0/command"
          op : add
          value: [ "-Mbignum=bpi", "-wle", "print bpi(2000)" ]
        - path : "/spec/backoffLimit"
          op: add
          value: 10
      validate:
        message: "This job should not be restarted"
        pattern:
          spec:
            template:
              spec:
                restartPolicy: Never
