apiVersion: kyverno.io/v2beta1
kind: ClusterCleanupPolicy
metadata:
  name: cleanup-pod
spec:
  context:
    - name: varname
      apiCall:
        urlPath: "/api/v1/namespaces/default/invalid"
        jmesPath: metadata.name
        default: default
    - name: varNamespace
      variable:
        value: "example"
  match:
    any:
      - resources:
          kinds:
            - Pod
  conditions:
    all:
      - key: "{{ target.metadata.name }}"
        operator: NotEquals
        value: "{{ varname }}"
      - key: "{{ target.metadata.namespace }}"
        operator: Equals
        value: "{{ varNamespace }}"
  ## execute every minute
  schedule: "*/1 * * * *"
